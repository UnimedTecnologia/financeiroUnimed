SELECT US.NM_USUARIO, US.DT_NASCIMENTO, IDADE(US.DT_NASCIMENTO, SYSDATE) AS IDADE, US.CD_MODALIDADE, MD.DS_MODALIDADE, 
       US.NR_PROPOSTA, US.NR_TER_ADESAO, US.CD_USUARIO, PT.CD_PLANO, PS.NM_PLANO, PT.CD_TIPO_PLANO, TS.NM_TIPO_PLANO, 
       TS.NM_TIPO_PLANO_REDUZ, CT.NM_CONTRATANTE, RM.DES_REGRA
  FROM GP.USUARIO US INNER JOIN GP.PROPOST               PT  ON US.CD_MODALIDADE   = PT.CD_MODALIDADE
                                                            AND US.NR_PROPOSTA     = PT.NR_PROPOSTA
                                                            AND US.LOG_17         <> 1
                      LEFT JOIN GP.CONTRAT               CT  ON PT.CD_CONTRATANTE  = CT.CD_CONTRATANTE
                     INNER JOIN GP.MODALID               MD  ON US.CD_MODALIDADE   = MD.CD_MODALIDADE
                     INNER JOIN GP.PLA_SAU               PS  ON US.CD_MODALIDADE   = PS.CD_MODALIDADE
                                                            AND PT.CD_PLANO        = PS.CD_PLANO
                     INNER JOIN GP.TI_PL_SA              TS  ON US.CD_MODALIDADE   = TS.CD_MODALIDADE
                                                            AND PT.CD_PLANO        = TS.CD_PLANO
                                                            AND PT.CD_TIPO_PLANO   = TS.CD_TIPO_PLANO
                      LEFT JOIN GP.REGRA_MENSLID_PROPOST RP  ON US.CD_MODALIDADE   = RP.CD_MODALIDADE
                                                            AND US.NR_PROPOSTA     = RP.NR_PROPOSTA
                                                            AND US.CD_USUARIO      = RP.CD_USUARIO
                      LEFT JOIN GP.REGRA_MENSLID         RM  ON RP.CDD_REGRA       = RM.CDD_REGRA
 WHERE US.CD_MODALIDADE = 40 -- COLETIVO ADESAO JUNDIAI
   AND EXTRACT(MONTH FROM US.DT_NASCIMENTO) = CASE WHEN EXTRACT(MONTH FROM SYSDATE) + 1 = 13 THEN 1 ELSE EXTRACT(MONTH FROM SYSDATE) + 1 END -- MES SUBSEQUENTE
   AND EXTRACT(YEAR  FROM US.DT_NASCIMENTO) = EXTRACT(YEAR  FROM SYSDATE) - 60 -- 60 ANOS
/*   AND ( EXTRACT(YEAR  FROM US.DT_NASCIMENTO) = EXTRACT(YEAR  FROM SYSDATE) - 59 
    OR EXTRACT(YEAR  FROM US.DT_NASCIMENTO) = EXTRACT(YEAR  FROM SYSDATE) - 60 )
   AND ( EXTRACT(MONTH FROM US.DT_NASCIMENTO) = EXTRACT(MONTH FROM SYSDATE) 
    OR   EXTRACT(MONTH FROM US.DT_NASCIMENTO) = CASE WHEN EXTRACT(MONTH FROM SYSDATE) + 1 = 13 THEN 1 ELSE EXTRACT(MONTH FROM SYSDATE) + 1 END ) */
 GROUP BY US.NM_USUARIO, US.DT_NASCIMENTO, US.CD_MODALIDADE, MD.DS_MODALIDADE, US.NR_PROPOSTA, US.NR_TER_ADESAO, US.CD_USUARIO,
          PT.CD_PLANO, PS.NM_PLANO, PT.CD_TIPO_PLANO, TS.NM_TIPO_PLANO, TS.NM_TIPO_PLANO_REDUZ, CT.NM_CONTRATANTE, RM.DES_REGRA
 ORDER BY US.CD_MODALIDADE, US.NR_PROPOSTA, US.CD_USUARIO, PT.CD_PLANO, PT.CD_TIPO_PLANO, US.NM_USUARIO;